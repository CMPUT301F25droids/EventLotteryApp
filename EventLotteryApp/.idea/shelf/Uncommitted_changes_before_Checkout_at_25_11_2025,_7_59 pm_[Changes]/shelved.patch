Index: app/src/main/java/com/example/eventlotteryapp/organizer/CreateEventActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.eventlotteryapp.organizer;\n\nimport android.app.AlertDialog;\nimport android.content.Intent;\nimport android.os.Build;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.view.Window;\nimport android.view.WindowManager;\nimport android.widget.Toast;\nimport androidx.annotation.Nullable;\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.lifecycle.ViewModelProvider;\nimport androidx.viewpager2.widget.ViewPager2;\nimport com.example.eventlotteryapp.OrganizerHomePage;\nimport com.example.eventlotteryapp.R;\nimport com.example.eventlotteryapp.data.Event;\nimport com.example.eventlotteryapp.databinding.ActivityCreateEventBinding;\nimport com.google.firebase.auth.FirebaseAuth;\nimport com.google.firebase.firestore.FirebaseFirestore;\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class CreateEventActivity extends AppCompatActivity {\n\n    private ActivityCreateEventBinding binding;\n    private FirebaseFirestore firestore;\n    private FirebaseAuth auth;\n    private CreateEventViewModel viewModel;\n    private CreateEventPagerAdapter pagerAdapter;\n    private String eventId; // null for create mode, non-null for edit mode\n\n    @Override\n    protected void onCreate(@Nullable Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        \n        // Set navigation bar color to white to prevent pink tint\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\n            Window window = getWindow();\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\n            window.setNavigationBarColor(getResources().getColor(R.color.white, getTheme()));\n            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {\n                window.getDecorView().setSystemUiVisibility(\n                    window.getDecorView().getSystemUiVisibility() | View.SYSTEM_UI_FLAG_LIGHT_NAVIGATION_BAR\n                );\n            }\n        }\n        \n        binding = ActivityCreateEventBinding.inflate(getLayoutInflater());\n        setContentView(binding.getRoot());\n\n        firestore = FirebaseFirestore.getInstance();\n        auth = FirebaseAuth.getInstance();\n        viewModel = new ViewModelProvider(this).get(CreateEventViewModel.class);\n        \n        // Check if we're in edit mode\n        eventId = getIntent().getStringExtra(\"eventId\");\n        if (eventId != null && !eventId.isEmpty()) {\n            setTitle(\"Edit Event\");\n            loadEventForEditing(eventId);\n        } else {\n            setTitle(\"Create Event\");\n        }\n\n        pagerAdapter = new CreateEventPagerAdapter(this);\n        binding.viewPager.setAdapter(pagerAdapter);\n        binding.viewPager.setUserInputEnabled(false); // Disable swipe\n\n        binding.backButton.setOnClickListener(v -> {\n            int currentItem = binding.viewPager.getCurrentItem();\n            if (currentItem > 0) {\n                binding.viewPager.setCurrentItem(currentItem - 1);\n            }\n        });\n\n        binding.nextButton.setOnClickListener(v -> {\n            int currentItem = binding.viewPager.getCurrentItem();\n            if (currentItem < pagerAdapter.getItemCount() - 1) {\n                binding.viewPager.setCurrentItem(currentItem + 1);\n            }\n        });\n\n        binding.viewPager.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n            @Override\n            public void onPageSelected(int position) {\n                super.onPageSelected(position);\n                updatePaginationIndicators(position);\n                updateButtonLayout(position);\n            }\n        });\n        \n        // Initialize pagination indicators and button layout for first page\n        updatePaginationIndicators(0);\n        updateButtonLayout(0);\n    }\n\n    private void updatePaginationIndicators(int currentPosition) {\n        View[] indicators = {\n            binding.pageIndicator1,\n            binding.pageIndicator2,\n            binding.pageIndicator3,\n            binding.pageIndicator4,\n            binding.pageIndicator5,\n            binding.pageIndicator6\n        };\n        \n        for (int i = 0; i < indicators.length; i++) {\n            if (i == currentPosition) {\n                indicators[i].setBackgroundResource(R.drawable.page_indicator_active);\n            } else {\n                indicators[i].setBackgroundResource(R.drawable.page_indicator_inactive);\n            }\n        }\n    }\n\n    private void updateButtonLayout(int position) {\n        // On step 6 (last step), hide navigation buttons as fragment has its own\n        if (position == pagerAdapter.getItemCount() - 1) {\n            binding.navigationButtons.setVisibility(View.GONE);\n            binding.paginationContainer.setVisibility(View.GONE);\n            return;\n        } else {\n            binding.navigationButtons.setVisibility(View.VISIBLE);\n            binding.paginationContainer.setVisibility(View.VISIBLE);\n        }\n\n        // Handle Back button visibility - when hidden, Next fills full width\n        if (position == 0) {\n            binding.backButton.setVisibility(View.GONE);\n            // Make Next button fill full width when Back is hidden\n            android.widget.LinearLayout.LayoutParams nextParams = \n                (android.widget.LinearLayout.LayoutParams) binding.nextButton.getLayoutParams();\n            nextParams.width = android.widget.LinearLayout.LayoutParams.MATCH_PARENT;\n            nextParams.weight = 0;\n            binding.nextButton.setLayoutParams(nextParams);\n        } else {\n            binding.backButton.setVisibility(View.VISIBLE);\n            // Make Next button share space with Back button\n            android.widget.LinearLayout.LayoutParams nextParams = \n                (android.widget.LinearLayout.LayoutParams) binding.nextButton.getLayoutParams();\n            nextParams.width = 0;\n            nextParams.weight = 1;\n            binding.nextButton.setLayoutParams(nextParams);\n        }\n\n        // Handle Next button text and action\n        binding.nextButton.setText(\"Next\");\n        binding.nextButton.setOnClickListener(v -> {\n            int currentItem = binding.viewPager.getCurrentItem();\n            if (currentItem < pagerAdapter.getItemCount() - 1) {\n                binding.viewPager.setCurrentItem(currentItem + 1);\n            }\n        });\n    }\n\n    @Override\n    public void onBackPressed() {\n        handleBackPress();\n    }\n\n    public void handleBackPress() {\n        if (hasEnteredData()) {\n            showExitConfirmationDialog();\n        } else {\n            finish();\n        }\n    }\n\n    private boolean hasEnteredData() {\n        String title = viewModel.title.getValue();\n        String description = viewModel.description.getValue();\n        String location = viewModel.location.getValue();\n        Double price = viewModel.price.getValue();\n        Date eventStartDate = viewModel.eventStartDate.getValue();\n        Date eventEndDate = viewModel.eventEndDate.getValue();\n        Date registrationOpenDate = viewModel.registrationOpenDate.getValue();\n        Date registrationCloseDate = viewModel.registrationCloseDate.getValue();\n        Integer maxParticipants = viewModel.maxParticipants.getValue();\n        Integer waitingListSize = viewModel.waitingListSize.getValue();\n        Boolean requireGeolocation = viewModel.requireGeolocation.getValue();\n        Boolean limitWaitingList = viewModel.limitWaitingList.getValue();\n\n        // Check if any field has been filled\n        return (title != null && !title.trim().isEmpty()) ||\n               (description != null && !description.trim().isEmpty()) ||\n               (location != null && !location.trim().isEmpty()) ||\n               (price != null && price > 0.0) ||\n               eventStartDate != null ||\n               eventEndDate != null ||\n               registrationOpenDate != null ||\n               registrationCloseDate != null ||\n               (maxParticipants != null && maxParticipants > 0) ||\n               (waitingListSize != null && waitingListSize > 0) ||\n               (requireGeolocation != null && requireGeolocation) ||\n               (limitWaitingList != null && limitWaitingList);\n    }\n\n    private void showExitConfirmationDialog() {\n        new AlertDialog.Builder(this)\n            .setTitle(\"Exit Event Creation?\")\n            .setMessage(\"You have entered some information. Are you sure you want to go back? Your progress will be lost.\")\n            .setPositiveButton(\"Go Back\", (dialog, which) -> {\n                finish();\n            })\n            .setNegativeButton(\"Cancel\", (dialog, which) -> {\n                // Do nothing, stay on current page\n            })\n            .show();\n    }\n\n    public void saveEvent() {\n        saveEvent(null);\n    }\n\n    public void saveEvent(OnEventSavedListener listener) {\n        String title = viewModel.title.getValue();\n        String description = viewModel.description.getValue();\n        String location = viewModel.location.getValue();\n        Double price = viewModel.price.getValue();\n        Date eventStartDate = viewModel.eventStartDate.getValue();\n        Date eventEndDate = viewModel.eventEndDate.getValue();\n        Date registrationOpenDate = viewModel.registrationOpenDate.getValue();\n        Date registrationCloseDate = viewModel.registrationCloseDate.getValue();\n        Integer maxParticipants = viewModel.maxParticipants.getValue();\n\n\n        if (title == null || title.isEmpty() ||\n            description == null || description.isEmpty() ||\n            location == null || location.isEmpty()) {\n            Toast.makeText(this, \"Please fill in all fields on the first page\", Toast.LENGTH_SHORT).show();\n            binding.viewPager.setCurrentItem(0);\n            return;\n        }\n\n        if (auth.getCurrentUser() == null) {\n            Toast.makeText(this, \"You must be logged in to create events. Please log in first.\", Toast.LENGTH_LONG).show();\n            android.util.Log.e(\"CreateEventActivity\", \"Cannot save event: User is not authenticated\");\n            return;\n        }\n        \n        String organizerId = auth.getCurrentUser().getUid();\n        Integer waitingListSize = viewModel.waitingListSize.getValue();\n        Boolean requireGeolocation = viewModel.requireGeolocation.getValue();\n        Boolean limitWaitingList = viewModel.limitWaitingList.getValue();\n        String posterImageBase64 = viewModel.posterImageBase64.getValue();\n        \n        android.util.Log.d(\"CreateEventActivity\", \"Saving event with organizerId: \" + organizerId);\n        android.util.Log.d(\"CreateEventActivity\", \"Event title: \" + title);\n        \n        // Use Map to ensure Firestore serialization works correctly\n        Map<String, Object> eventData = new HashMap<>();\n        \n        // OLD SYSTEM FIELDS (to match existing Events collection structure)\n        eventData.put(\"Name\", title);  // Old field name\n        eventData.put(\"Cost\", price != null ? String.format(\"$%.2f\", price) : \"$0.00\");  // Old field name, formatted as string\n        eventData.put(\"Organizer\", firestore.collection(\"Users\").document(organizerId));  // Old field name, as DocumentReference\n        if (posterImageBase64 != null && !posterImageBase64.isEmpty()) {\n            eventData.put(\"Image\", posterImageBase64);  // Old field name, base64 string\n        }\n        \n        // Waitlist structure (old system format - array)\n        eventData.put(\"Waitlist\", new ArrayList<String>());  // Initialize with empty array\n        \n        // NEW SYSTEM FIELDS (additional fields for new functionality)\n        eventData.put(\"title\", title);  // Keep for backward compatibility\n        eventData.put(\"description\", description);\n        eventData.put(\"location\", location);\n        eventData.put(\"price\", price != null ? price : 0.0);  // Keep numeric price\n        // organizerId removed - using Organizer DocumentReference instead\n        \n        // Event dates\n        eventData.put(\"eventStartDate\", eventStartDate);\n        eventData.put(\"eventEndDate\", eventEndDate);\n        eventData.put(\"registrationOpenDate\", registrationOpenDate);\n        eventData.put(\"registrationCloseDate\", registrationCloseDate);\n        \n        // Participant settings\n        eventData.put(\"maxParticipants\", maxParticipants != null ? maxParticipants : 0);\n        eventData.put(\"waitingListSize\", waitingListSize != null ? waitingListSize : 0);\n        eventData.put(\"limitWaitingList\", limitWaitingList != null ? limitWaitingList : false);\n        \n        // Event settings\n        eventData.put(\"requireGeolocation\", requireGeolocation != null ? requireGeolocation : false);\n        \n        // Only initialize empty lists for new events, preserve existing lists for edits\n        if (eventId == null) {\n            eventData.put(\"waitingListEntrantIds\", new ArrayList<String>());\n            eventData.put(\"selectedEntrantIds\", new ArrayList<String>());\n            eventData.put(\"cancelledEntrantIds\", new ArrayList<String>());\n            // createdAt will be set by Firestore server timestamp for new events\n            eventData.put(\"createdAt\", com.google.firebase.firestore.FieldValue.serverTimestamp());\n        }\n        // For edit mode, we don't overwrite existing lists or createdAt\n\n        if (eventId != null) {\n            // Update existing event\n            firestore.collection(\"Events\").document(eventId)\n                    .update(eventData)\n                    .addOnSuccessListener(aVoid -> {\n                        android.util.Log.d(\"CreateEventActivity\", \"Event updated successfully with ID: \" + eventId);\n                        Toast.makeText(this, \"Event updated successfully\", Toast.LENGTH_SHORT).show();\n                        \n                        if (listener != null) {\n                            listener.onEventSaved(eventId);\n                        } else {\n                            finish();\n                        }\n                    })\n                    .addOnFailureListener(e -> {\n                        android.util.Log.e(\"CreateEventActivity\", \"Error updating event\", e);\n                        Toast.makeText(this, \"Error updating event: \" + e.getMessage(), Toast.LENGTH_SHORT).show();\n                    });\n        } else {\n            // Create new event\n            firestore.collection(\"Events\")\n                    .add(eventData)\n                    .addOnSuccessListener(documentReference -> {\n                        String newEventId = documentReference.getId();\n                        android.util.Log.d(\"CreateEventActivity\", \"Event saved successfully with ID: \" + newEventId);\n                        android.util.Log.d(\"CreateEventActivity\", \"Event organizerId: \" + organizerId);\n                        \n                        // Verify the saved event\n                        firestore.collection(\"Events\").document(newEventId).get()\n                            .addOnSuccessListener(documentSnapshot -> {\n                                if (documentSnapshot.exists()) {\n                                    String savedOrganizerId = documentSnapshot.getString(\"organizerId\");\n                                    android.util.Log.d(\"CreateEventActivity\", \"Verified saved event - organizerId in Firestore: \" + savedOrganizerId);\n                                }\n                            });\n                        \n                        Toast.makeText(this, \"Event created successfully\", Toast.LENGTH_SHORT).show();\n                        \n                        if (listener != null) {\n                            listener.onEventSaved(newEventId);\n                        } else {\n                            // Use finish() to return to previous activity instead of recreating it\n                            // This ensures the fragment's onResume() is called\n                            finish();\n                        }\n                    })\n                    .addOnFailureListener(e -> {\n                        android.util.Log.e(\"CreateEventActivity\", \"Error creating event\", e);\n                        Toast.makeText(this, \"Error creating event: \" + e.getMessage(), Toast.LENGTH_SHORT).show();\n                    });\n        }\n    }\n\n    private void loadEventForEditing(String eventId) {\n        firestore.collection(\"Events\").document(eventId)\n            .get()\n            .addOnSuccessListener(documentSnapshot -> {\n                if (!documentSnapshot.exists()) {\n                    android.util.Log.e(\"CreateEventActivity\", \"Event not found for editing: \" + eventId);\n                    Toast.makeText(this, \"Event not found\", Toast.LENGTH_SHORT).show();\n                    finish();\n                    return;\n                }\n                \n                // Populate ViewModel with event data\n                viewModel.title.setValue(documentSnapshot.getString(\"title\") != null ? \n                    documentSnapshot.getString(\"title\") : documentSnapshot.getString(\"Name\"));\n                viewModel.description.setValue(documentSnapshot.getString(\"description\"));\n                viewModel.location.setValue(documentSnapshot.getString(\"location\"));\n                \n                // Price\n                Double price = documentSnapshot.getDouble(\"price\");\n                if (price == null) {\n                    String costStr = documentSnapshot.getString(\"Cost\");\n                    if (costStr != null && costStr.startsWith(\"$\")) {\n                        try {\n                            price = Double.parseDouble(costStr.substring(1));\n                        } catch (NumberFormatException e) {\n                            price = 0.0;\n                        }\n                    } else {\n                        price = 0.0;\n                    }\n                }\n                viewModel.price.setValue(price);\n                \n                // Dates\n                viewModel.eventStartDate.setValue(documentSnapshot.getDate(\"eventStartDate\"));\n                viewModel.eventEndDate.setValue(documentSnapshot.getDate(\"eventEndDate\"));\n                viewModel.registrationOpenDate.setValue(documentSnapshot.getDate(\"registrationOpenDate\"));\n                viewModel.registrationCloseDate.setValue(documentSnapshot.getDate(\"registrationCloseDate\"));\n                \n                // Participant settings\n                Long maxParticipantsLong = documentSnapshot.getLong(\"maxParticipants\");\n                viewModel.maxParticipants.setValue(maxParticipantsLong != null ? maxParticipantsLong.intValue() : 0);\n                \n                Long waitingListSizeLong = documentSnapshot.getLong(\"waitingListSize\");\n                viewModel.waitingListSize.setValue(waitingListSizeLong != null ? waitingListSizeLong.intValue() : 0);\n                \n                // Settings\n                Boolean requireGeolocation = documentSnapshot.getBoolean(\"requireGeolocation\");\n                viewModel.requireGeolocation.setValue(requireGeolocation != null ? requireGeolocation : false);\n                \n                Boolean limitWaitingList = documentSnapshot.getBoolean(\"limitWaitingList\");\n                viewModel.limitWaitingList.setValue(limitWaitingList != null ? limitWaitingList : false);\n                \n                // Image\n                String posterImageBase64 = documentSnapshot.getString(\"Image\");\n                if (posterImageBase64 != null && !posterImageBase64.isEmpty()) {\n                    viewModel.posterImageBase64.setValue(posterImageBase64);\n                    // Note: posterImageUri will be set by Step5Fragment when it observes posterImageBase64\n                }\n                \n                android.util.Log.d(\"CreateEventActivity\", \"Event data loaded for editing\");\n            })\n            .addOnFailureListener(e -> {\n                android.util.Log.e(\"CreateEventActivity\", \"Error loading event for editing\", e);\n                Toast.makeText(this, \"Error loading event: \" + e.getMessage(), Toast.LENGTH_SHORT).show();\n                finish();\n            });\n    }\n\n    public interface OnEventSavedListener {\n        void onEventSaved(String eventId);\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/eventlotteryapp/organizer/CreateEventActivity.java b/app/src/main/java/com/example/eventlotteryapp/organizer/CreateEventActivity.java
--- a/app/src/main/java/com/example/eventlotteryapp/organizer/CreateEventActivity.java	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ b/app/src/main/java/com/example/eventlotteryapp/organizer/CreateEventActivity.java	(date 1764125335915)
@@ -286,11 +286,11 @@
         
         // Only initialize empty lists for new events, preserve existing lists for edits
         if (eventId == null) {
-            eventData.put("waitingListEntrantIds", new ArrayList<String>());
-            eventData.put("selectedEntrantIds", new ArrayList<String>());
-            eventData.put("cancelledEntrantIds", new ArrayList<String>());
+        eventData.put("waitingListEntrantIds", new ArrayList<String>());
+        eventData.put("selectedEntrantIds", new ArrayList<String>());
+        eventData.put("cancelledEntrantIds", new ArrayList<String>());
             // createdAt will be set by Firestore server timestamp for new events
-            eventData.put("createdAt", com.google.firebase.firestore.FieldValue.serverTimestamp());
+        eventData.put("createdAt", com.google.firebase.firestore.FieldValue.serverTimestamp());
         }
         // For edit mode, we don't overwrite existing lists or createdAt
 
@@ -314,35 +314,35 @@
                     });
         } else {
             // Create new event
-            firestore.collection("Events")
-                    .add(eventData)
-                    .addOnSuccessListener(documentReference -> {
+        firestore.collection("Events")
+                .add(eventData)
+                .addOnSuccessListener(documentReference -> {
                         String newEventId = documentReference.getId();
                         android.util.Log.d("CreateEventActivity", "Event saved successfully with ID: " + newEventId);
-                        android.util.Log.d("CreateEventActivity", "Event organizerId: " + organizerId);
-                        
-                        // Verify the saved event
+                    android.util.Log.d("CreateEventActivity", "Event organizerId: " + organizerId);
+                    
+                    // Verify the saved event
                         firestore.collection("Events").document(newEventId).get()
-                            .addOnSuccessListener(documentSnapshot -> {
-                                if (documentSnapshot.exists()) {
-                                    String savedOrganizerId = documentSnapshot.getString("organizerId");
-                                    android.util.Log.d("CreateEventActivity", "Verified saved event - organizerId in Firestore: " + savedOrganizerId);
-                                }
-                            });
-                        
-                        Toast.makeText(this, "Event created successfully", Toast.LENGTH_SHORT).show();
-                        
-                        if (listener != null) {
+                        .addOnSuccessListener(documentSnapshot -> {
+                            if (documentSnapshot.exists()) {
+                                String savedOrganizerId = documentSnapshot.getString("organizerId");
+                                android.util.Log.d("CreateEventActivity", "Verified saved event - organizerId in Firestore: " + savedOrganizerId);
+                            }
+                        });
+                    
+                    Toast.makeText(this, "Event created successfully", Toast.LENGTH_SHORT).show();
+                    
+                    if (listener != null) {
                             listener.onEventSaved(newEventId);
-                        } else {
-                            // Use finish() to return to previous activity instead of recreating it
-                            // This ensures the fragment's onResume() is called
-                            finish();
-                        }
-                    })
-                    .addOnFailureListener(e -> {
-                        android.util.Log.e("CreateEventActivity", "Error creating event", e);
-                        Toast.makeText(this, "Error creating event: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+                    } else {
+                        // Use finish() to return to previous activity instead of recreating it
+                        // This ensures the fragment's onResume() is called
+                        finish();
+                    }
+                })
+                .addOnFailureListener(e -> {
+                    android.util.Log.e("CreateEventActivity", "Error creating event", e);
+                    Toast.makeText(this, "Error creating event: " + e.getMessage(), Toast.LENGTH_SHORT).show();
                     });
         }
     }
@@ -413,7 +413,7 @@
                 android.util.Log.e("CreateEventActivity", "Error loading event for editing", e);
                 Toast.makeText(this, "Error loading event: " + e.getMessage(), Toast.LENGTH_SHORT).show();
                 finish();
-            });
+                });
     }
 
     public interface OnEventSavedListener {
Index: app/src/main/res/drawable/ic_hourglass.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_hourglass.xml b/app/src/main/res/drawable/ic_hourglass.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/ic_hourglass.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,13 +0,0 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android"
-    android:width="24dp"
-    android:height="24dp"
-    android:viewportWidth="24"
-    android:viewportHeight="24">
-    <path
-        android:fillColor="#8B4513"
-        android:pathData="M6,2h12v2H6V2zM8,4v4l4,4 4,-4V4H8zM6,20h12v2H6V20zM8,20v-4l4,-4 4,4v4H8z"/>
-    <path
-        android:fillColor="#8B4513"
-        android:pathData="M12,10L8,14h8L12,10z"/>
-</vector>
-
Index: app/src/main/res/drawable/circular_avatar.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/circular_avatar.xml b/app/src/main/res/drawable/circular_avatar.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/circular_avatar.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<shape xmlns:android="http://schemas.android.com/apk/res/android"
-    android:shape="oval">
-    <solid android:color="@color/opaque_light_grey" />
-</shape>
-
Index: app/src/main/res/drawable/ic_search.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_search.xml b/app/src/main/res/drawable/ic_search.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/ic_search.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,10 +0,0 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android"
-    android:width="24dp"
-    android:height="24dp"
-    android:viewportWidth="24"
-    android:viewportHeight="24">
-    <path
-        android:fillColor="#000000"
-        android:pathData="M15.5,14h-0.79l-0.28,-0.27C15.41,12.59 16,11.11 16,9.5 16,5.91 13.09,3 9.5,3S3,5.91 3,9.5 5.91,16 9.5,16c1.61,0 3.09,-0.59 4.23,-1.57l0.27,0.28v0.79l5,4.99L20.49,19l-4.99,-5zM9.5,14C7.01,14 5,11.99 5,9.5S7.01,5 9.5,5 14,7.01 14,9.5 11.99,14 9.5,14z"/>
-</vector>
-
Index: app/src/main/res/drawable/chip_background.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/chip_background.xml b/app/src/main/res/drawable/chip_background.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/chip_background.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,10 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<shape xmlns:android="http://schemas.android.com/apk/res/android"
-    android:shape="rectangle">
-    <solid android:color="@color/white" />
-    <stroke
-        android:width="0.5dp"
-        android:color="#1F000000" />
-    <corners android:radius="12dp" />
-</shape>
-
Index: app/src/main/res/drawable/ic_pending.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_pending.xml b/app/src/main/res/drawable/ic_pending.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/ic_pending.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,10 +0,0 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android"
-    android:width="24dp"
-    android:height="24dp"
-    android:viewportWidth="24"
-    android:viewportHeight="24">
-    <path
-        android:fillColor="#000000"
-        android:pathData="M6,8h2v8H6V8zM10,8h2v8h-2V8z"/>
-</vector>
-
Index: app/src/main/res/drawable/ic_declined.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_declined.xml b/app/src/main/res/drawable/ic_declined.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/ic_declined.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,13 +0,0 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android"
-    android:width="24dp"
-    android:height="24dp"
-    android:viewportWidth="24"
-    android:viewportHeight="24">
-    <path
-        android:fillColor="#000000"
-        android:pathData="M15,3H6C4.9,3 4,3.9 4,5v14c0,1.1 0.9,2 2,2h9c1.1,0 2,-0.9 2,-2V5C17,3.9 16.1,3 15,3zM13,14h-2v-2h2V14zM13,10h-2V8h2V10z"/>
-    <path
-        android:fillColor="#000000"
-        android:pathData="M22,3h-2v14h2V3z"/>
-</vector>
-
Index: app/src/main/res/drawable/ic_edit.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_edit.xml b/app/src/main/res/drawable/ic_edit.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/ic_edit.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,10 +0,0 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android"
-    android:width="24dp"
-    android:height="24dp"
-    android:viewportWidth="24"
-    android:viewportHeight="24">
-    <path
-        android:fillColor="#000000"
-        android:pathData="M3,17.25V21h3.75L17.81,9.94l-3.75,-3.75L3,17.25zM20.71,7.04c0.39,-0.39 0.39,-1.02 0,-1.41l-2.34,-2.34c-0.39,-0.39 -1.02,-0.39 -1.41,0l-1.83,1.83 3.75,3.75 1.83,-1.83z"/>
-</vector>
-
Index: app/src/main/res/drawable/ic_menu.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_menu.xml b/app/src/main/res/drawable/ic_menu.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/ic_menu.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,10 +0,0 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android"
-    android:width="24dp"
-    android:height="24dp"
-    android:viewportWidth="24"
-    android:viewportHeight="24">
-    <path
-        android:fillColor="#000000"
-        android:pathData="M3,18h18v-2H3V18zM3,13h18v-2H3V13zM3,6v2h18V6H3z"/>
-</vector>
-
Index: app/src/main/res/drawable/ic_bar_chart.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_bar_chart.xml b/app/src/main/res/drawable/ic_bar_chart.xml
deleted file mode 100644
--- a/app/src/main/res/drawable/ic_bar_chart.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ /dev/null	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
@@ -1,10 +0,0 @@
-<vector xmlns:android="http://schemas.android.com/apk/res/android"
-    android:width="24dp"
-    android:height="24dp"
-    android:viewportWidth="24"
-    android:viewportHeight="24">
-    <path
-        android:fillColor="#4CAF50"
-        android:pathData="M5,9.2h3V19H5V9.2zM10.6,5h2.8v14h-2.8V5zM16.2,13H19v6h-2.8V13z"/>
-</vector>
-
Index: app/src/main/res/drawable/status_indicator_yellow.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:shape=\"oval\">\n    <solid android:color=\"#FFC107\" />\n</shape>\n\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/status_indicator_yellow.xml b/app/src/main/res/drawable/status_indicator_yellow.xml
--- a/app/src/main/res/drawable/status_indicator_yellow.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ b/app/src/main/res/drawable/status_indicator_yellow.xml	(date 1764125336032)
@@ -3,5 +3,3 @@
     android:shape="oval">
     <solid android:color="#FFC107" />
 </shape>
-
-
Index: app/src/main/java/com/example/eventlotteryapp/EntrantView/JoinConfirmationFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.eventlotteryapp.EntrantView;\n\nimport android.Manifest;\nimport android.content.Intent;\nimport android.content.pm.PackageManager;\nimport android.location.Location;\nimport android.os.Bundle;\nimport android.widget.Toast;\n\nimport androidx.annotation.Nullable;\nimport androidx.annotation.NonNull;\nimport androidx.core.app.ActivityCompat;\nimport androidx.core.content.ContextCompat;\n\nimport com.example.eventlotteryapp.UserSession;\nimport com.google.android.gms.location.FusedLocationProviderClient;\nimport com.google.android.gms.location.LocationServices;\nimport com.google.android.material.bottomsheet.BottomSheetDialogFragment;\n\nimport android.util.Log;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.Button;\n\nimport com.example.eventlotteryapp.R;\nimport com.example.eventlotteryapp.databinding.FragmentJoinConfirmationListDialogBinding;\nimport com.google.firebase.firestore.DocumentReference;\nimport com.google.firebase.firestore.FirebaseFirestore;\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * <p>A fragment that shows a list of items as a modal bottom sheet.</p>\n * <p>You can show this modal bottom sheet from your activity like this:</p>\n * <pre>\n *     JoinConfirmationFragment.newInstance(30).show(getSupportFragmentManager(), \"dialog\");\n * </pre>\n */\npublic class JoinConfirmationFragment extends BottomSheetDialogFragment {\n\n    // TODO: Customize parameter argument names\n    private static final String ARG_EVENT_ID = \"event_id\";\n    private static final int LOCATION_PERMISSION_REQUEST_CODE = 1001;\n    private String eventId;\n    private FragmentJoinConfirmationListDialogBinding binding;\n    private FusedLocationProviderClient fusedLocationClient;\n\n    // TODO: Customize parameters\n    public static JoinConfirmationFragment newInstance(String eventId) {\n        final JoinConfirmationFragment fragment = new JoinConfirmationFragment();\n        final Bundle args = new Bundle();\n        args.putString(ARG_EVENT_ID, eventId);\n        fragment.setArguments(args);\n        return fragment;\n    }\n\n    @Nullable\n    @Override\n    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container,\n                             @Nullable Bundle savedInstanceState) {\n        this.eventId = getArguments().getString(ARG_EVENT_ID);\n        return inflater.inflate(R.layout.fragment_join_confirmation_list_dialog, container, false);\n\n    }\n\n    @Override\n    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\n        super.onViewCreated(view, savedInstanceState);\n        Button joinButton = view.findViewById(R.id.confirm_join_button);\n        Button cancelButton = view.findViewById(R.id.cancel_join_button);\n\n        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireContext());\n\n        joinButton.setOnClickListener(v -> {\n            // Check if event requires geolocation\n            FirebaseFirestore db = FirebaseFirestore.getInstance();\n            db.collection(\"Events\").document(eventId)\n                .get()\n                .addOnSuccessListener(eventDoc -> {\n                    Boolean requireGeolocation = eventDoc.getBoolean(\"requireGeolocation\");\n                    boolean needsLocation = (requireGeolocation != null && requireGeolocation);\n                    \n                    if (needsLocation) {\n                        // Geolocation is required - must capture location\n                        requestLocationAndJoin();\n                    } else {\n                        // Geolocation is optional - try to get location but don't require it\n                        tryToGetLocationAndJoin();\n                    }\n                })\n                .addOnFailureListener(e -> {\n                    Log.e(\"Firestore\", \"Error checking geolocation requirement\", e);\n                    // Join without location if we can't check\n                    joinEvent(null, null);\n                });\n        });\n\n        cancelButton.setOnClickListener(v -> dismiss());\n    }\n    \n    private void requestLocationAndJoin() {\n        // Check permissions\n        if (ContextCompat.checkSelfPermission(requireContext(), Manifest.permission.ACCESS_FINE_LOCATION) \n                != PackageManager.PERMISSION_GRANTED) {\n            // Request permission\n            requestPermissions(new String[]{Manifest.permission.ACCESS_FINE_LOCATION}, \n                    LOCATION_PERMISSION_REQUEST_CODE);\n            return;\n        }\n        \n        // Get location (required)\n        if (ActivityCompat.checkSelfPermission(requireContext(), Manifest.permission.ACCESS_FINE_LOCATION) \n                == PackageManager.PERMISSION_GRANTED) {\n            fusedLocationClient.getLastLocation()\n                .addOnSuccessListener(location -> {\n                    if (location != null) {\n                        joinEvent(location.getLatitude(), location.getLongitude());\n                    } else {\n                        // Location not available - required, so show error\n                        Toast.makeText(requireContext(), \"Location is required but not available. Please enable location services.\", Toast.LENGTH_LONG).show();\n                    }\n                })\n                .addOnFailureListener(e -> {\n                    Log.e(\"Location\", \"Error getting location\", e);\n                    Toast.makeText(requireContext(), \"Could not get location. Location is required for this event.\", Toast.LENGTH_LONG).show();\n                });\n        } else {\n            Toast.makeText(requireContext(), \"Location permission is required for this event.\", Toast.LENGTH_LONG).show();\n        }\n    }\n    \n    private void tryToGetLocationAndJoin() {\n        // Check permissions\n        if (ContextCompat.checkSelfPermission(requireContext(), Manifest.permission.ACCESS_FINE_LOCATION) \n                != PackageManager.PERMISSION_GRANTED) {\n            // Permission not granted - join without location (it's optional)\n            joinEvent(null, null);\n            return;\n        }\n        \n        // Try to get location (optional)\n        if (ActivityCompat.checkSelfPermission(requireContext(), Manifest.permission.ACCESS_FINE_LOCATION) \n                == PackageManager.PERMISSION_GRANTED) {\n            fusedLocationClient.getLastLocation()\n                .addOnSuccessListener(location -> {\n                    if (location != null) {\n                        // Got location - save it\n                        joinEvent(location.getLatitude(), location.getLongitude());\n                    } else {\n                        // Location not available - that's okay, it's optional\n                        joinEvent(null, null);\n                    }\n                })\n                .addOnFailureListener(e -> {\n                    Log.e(\"Location\", \"Error getting location\", e);\n                    // Failed to get location - that's okay, it's optional\n                    joinEvent(null, null);\n                });\n        } else {\n            // No permission - that's okay, it's optional\n            joinEvent(null, null);\n        }\n    }\n    \n    @Override\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\n        if (requestCode == LOCATION_PERMISSION_REQUEST_CODE) {\n            if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {\n                requestLocationAndJoin();\n            } else {\n                Toast.makeText(requireContext(), \"Location permission denied. Joining without location.\", Toast.LENGTH_SHORT).show();\n                joinEvent(null, null);\n            }\n        }\n    }\n    \n    private void joinEvent(Double latitude, Double longitude) {\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\n        UserSession user_session = new UserSession();\n        DocumentReference user_ref = UserSession.getCurrentUserRef();\n        String userId = user_ref.getId();\n\n        DocumentReference event_ref = db.collection(\"Events\").document(eventId);\n        \n        // Update old system waitlist\n        event_ref.update(\"Waitlist\", com.google.firebase.firestore.FieldValue.arrayUnion(user_ref))\n                .addOnSuccessListener(aVoid -> {\n                    Log.d(\"Firestore\", \"User added to waitlist\");\n                })\n                .addOnFailureListener(e -> Log.e(\"Firestore\", \"Error adding user to waitlist\", e));\n        \n        // Update new system waiting list\n        event_ref.update(\"waitingListEntrantIds\", com.google.firebase.firestore.FieldValue.arrayUnion(userId))\n                .addOnSuccessListener(aVoid -> {\n                    Log.d(\"Firestore\", \"User added to new waiting list\");\n                })\n                .addOnFailureListener(e -> Log.e(\"Firestore\", \"Error adding user to new waiting list\", e));\n        \n        // Update user's joined events\n        user_ref.update(\"JoinedEvents\", com.google.firebase.firestore.FieldValue.arrayUnion(event_ref))\n                .addOnSuccessListener(aVoid -> {\n                    Log.d(\"Firestore\", \"Events added to users joined events\");\n                })\n                .addOnFailureListener(e -> Log.e(\"Firestore\", \"Error adding user to waitlist\", e));\n\n        // Store location if available\n        if (latitude != null && longitude != null) {\n            Map<String, Object> locationData = new HashMap<>();\n            locationData.put(\"latitude\", latitude);\n            locationData.put(\"longitude\", longitude);\n            locationData.put(\"timestamp\", com.google.firebase.firestore.FieldValue.serverTimestamp());\n            \n            db.collection(\"Events\").document(eventId)\n                .collection(\"joinLocations\").document(userId)\n                .set(locationData)\n                .addOnSuccessListener(aVoid -> {\n                    Log.d(\"Firestore\", \"Location saved for user\");\n                })\n                .addOnFailureListener(e -> {\n                    Log.e(\"Firestore\", \"Error saving location\", e);\n                });\n        }\n\n        // Handle join action\n        Intent intent = new Intent(getContext(), EntrantHomePageActivity.class);\n        intent.putExtra(\"open_tab\", 1); // e.g. 0 = Home, 1 = MyEvents, 2 = Notifications\n        startActivity(intent);\n\n        dismiss(); // close modal\n    }\n\n\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/eventlotteryapp/EntrantView/JoinConfirmationFragment.java b/app/src/main/java/com/example/eventlotteryapp/EntrantView/JoinConfirmationFragment.java
--- a/app/src/main/java/com/example/eventlotteryapp/EntrantView/JoinConfirmationFragment.java	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ b/app/src/main/java/com/example/eventlotteryapp/EntrantView/JoinConfirmationFragment.java	(date 1764125336037)
@@ -177,19 +177,19 @@
     }
     
     private void joinEvent(Double latitude, Double longitude) {
-        FirebaseFirestore db = FirebaseFirestore.getInstance();
-        UserSession user_session = new UserSession();
-        DocumentReference user_ref = UserSession.getCurrentUserRef();
+                    FirebaseFirestore db = FirebaseFirestore.getInstance();
+                    UserSession user_session = new UserSession();
+                    DocumentReference user_ref = UserSession.getCurrentUserRef();
         String userId = user_ref.getId();
 
-        DocumentReference event_ref = db.collection("Events").document(eventId);
+                    DocumentReference event_ref = db.collection("Events").document(eventId);
         
         // Update old system waitlist
-        event_ref.update("Waitlist", com.google.firebase.firestore.FieldValue.arrayUnion(user_ref))
-                .addOnSuccessListener(aVoid -> {
-                    Log.d("Firestore", "User added to waitlist");
-                })
-                .addOnFailureListener(e -> Log.e("Firestore", "Error adding user to waitlist", e));
+                    event_ref.update("Waitlist", com.google.firebase.firestore.FieldValue.arrayUnion(user_ref))
+                            .addOnSuccessListener(aVoid -> {
+                                Log.d("Firestore", "User added to waitlist");
+                            })
+                            .addOnFailureListener(e -> Log.e("Firestore", "Error adding user to waitlist", e));
         
         // Update new system waiting list
         event_ref.update("waitingListEntrantIds", com.google.firebase.firestore.FieldValue.arrayUnion(userId))
@@ -199,11 +199,11 @@
                 .addOnFailureListener(e -> Log.e("Firestore", "Error adding user to new waiting list", e));
         
         // Update user's joined events
-        user_ref.update("JoinedEvents", com.google.firebase.firestore.FieldValue.arrayUnion(event_ref))
-                .addOnSuccessListener(aVoid -> {
-                    Log.d("Firestore", "Events added to users joined events");
-                })
-                .addOnFailureListener(e -> Log.e("Firestore", "Error adding user to waitlist", e));
+                    user_ref.update("JoinedEvents", com.google.firebase.firestore.FieldValue.arrayUnion(event_ref))
+                            .addOnSuccessListener(aVoid -> {
+                                Log.d("Firestore", "Events added to users joined events");
+                            })
+                            .addOnFailureListener(e -> Log.e("Firestore", "Error adding user to waitlist", e));
 
         // Store location if available
         if (latitude != null && longitude != null) {
@@ -223,12 +223,12 @@
                 });
         }
 
-        // Handle join action
-        Intent intent = new Intent(getContext(), EntrantHomePageActivity.class);
-        intent.putExtra("open_tab", 1); // e.g. 0 = Home, 1 = MyEvents, 2 = Notifications
-        startActivity(intent);
+            // Handle join action
+            Intent intent = new Intent(getContext(), EntrantHomePageActivity.class);
+            intent.putExtra("open_tab", 1); // e.g. 0 = Home, 1 = MyEvents, 2 = Notifications
+            startActivity(intent);
 
-        dismiss(); // close modal
+            dismiss(); // close modal
     }
 
 
Index: app/src/main/res/drawable/status_indicator_red.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:shape=\"oval\">\n    <solid android:color=\"#F44336\" />\n</shape>\n\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/status_indicator_red.xml b/app/src/main/res/drawable/status_indicator_red.xml
--- a/app/src/main/res/drawable/status_indicator_red.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ b/app/src/main/res/drawable/status_indicator_red.xml	(date 1764125336042)
@@ -3,5 +3,3 @@
     android:shape="oval">
     <solid android:color="#F44336" />
 </shape>
-
-
Index: app/src/main/res/drawable/status_indicator_green.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:shape=\"oval\">\n    <solid android:color=\"#4CAF50\" />\n</shape>\n\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/status_indicator_green.xml b/app/src/main/res/drawable/status_indicator_green.xml
--- a/app/src/main/res/drawable/status_indicator_green.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ b/app/src/main/res/drawable/status_indicator_green.xml	(date 1764125336052)
@@ -3,5 +3,3 @@
     android:shape="oval">
     <solid android:color="#4CAF50" />
 </shape>
-
-
Index: app/src/main/java/com/example/eventlotteryapp/organizer/EntrantListActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.eventlotteryapp.organizer;\n\nimport android.app.AlertDialog;\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.text.Editable;\nimport android.text.TextWatcher;\nimport android.util.Log;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.ImageView;\nimport android.widget.LinearLayout;\nimport android.widget.TextView;\nimport android.widget.Toast;\nimport androidx.annotation.NonNull;\nimport androidx.activity.EdgeToEdge;\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\nimport com.example.eventlotteryapp.CsvExportController;\nimport com.example.eventlotteryapp.NotificationController;\nimport com.example.eventlotteryapp.R;\nimport com.example.eventlotteryapp.models.Entrant;\nimport com.example.eventlotteryapp.models.User;\nimport org.osmdroid.api.IMapController;\nimport org.osmdroid.config.Configuration;\nimport org.osmdroid.tileprovider.tilesource.TileSourceFactory;\nimport org.osmdroid.util.GeoPoint;\nimport org.osmdroid.views.MapView;\nimport org.osmdroid.views.overlay.Marker;\nimport org.osmdroid.views.overlay.mylocation.MyLocationNewOverlay;\nimport com.google.firebase.firestore.DocumentSnapshot;\nimport com.google.firebase.firestore.FirebaseFirestore;\nimport com.google.android.material.tabs.TabLayout;\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Locale;\nimport java.util.Random;\n\n/**\n * Displays and manages the waiting list for an event.\n * Shows entrants with their status (Pending, Selected, Declined) and allows filtering.\n */\npublic class EntrantListActivity extends AppCompatActivity {\n\n    private static final String TAG = \"EntrantListActivity\";\n    \n    private String eventId;\n    private FirebaseFirestore firestore;\n    private NotificationController notificationController;\n    private CsvExportController csvExportController;\n    \n    // UI Components\n    private TextView eventNameText;\n    private TextView registrationEndsText;\n    private TextView totalEntrantsText;\n    private TextView slotsAvailableText;\n    private EditText searchEditText;\n    private RecyclerView entrantsRecyclerView;\n    private Button runLotteryButton;\n    private Button exportCsvButton;\n    private MapView entrantsMapView;\n    private IMapController mapController;\n    private boolean requiresGeolocation = false;\n    \n    // Filter tabs\n    private LinearLayout filterAllTab;\n    private LinearLayout filterPendingTab;\n    private LinearLayout filterSelectedTab;\n    private LinearLayout filterDeclinedTab;\n    \n    private String currentFilter = \"all\"; // all, pending, selected, declined\n    private List<EntrantWithStatus> allEntrants = new ArrayList<>();\n    private List<EntrantWithStatus> filteredEntrants = new ArrayList<>();\n    private WaitingListAdapter adapter;\n    \n    private SimpleDateFormat dateFormat = new SimpleDateFormat(\"MMM d, yyyy\", Locale.getDefault());\n    private SimpleDateFormat joinDateFormat = new SimpleDateFormat(\"MMM d\", Locale.getDefault());\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        EdgeToEdge.enable(this);\n        setContentView(R.layout.activity_manage_waiting_list);\n        \n        eventId = getIntent().getStringExtra(\"eventId\");\n        if (eventId == null || eventId.isEmpty()) {\n            Toast.makeText(this, \"Event ID not provided\", Toast.LENGTH_SHORT).show();\n            finish();\n            return;\n        }\n        \n        firestore = FirebaseFirestore.getInstance();\n        notificationController = new NotificationController();\n        csvExportController = new CsvExportController();\n        \n        initializeViews();\n        setupClickListeners();\n        loadEventData();\n        loadEntrants();\n    }\n    \n    private void initializeViews() {\n        eventNameText = findViewById(R.id.event_name_text);\n        registrationEndsText = findViewById(R.id.registration_ends_text);\n        totalEntrantsText = findViewById(R.id.total_entrants_text);\n        slotsAvailableText = findViewById(R.id.slots_available_text);\n        searchEditText = findViewById(R.id.search_edit_text);\n        entrantsRecyclerView = findViewById(R.id.entrants_recycler_view);\n        runLotteryButton = findViewById(R.id.run_lottery_button);\n        exportCsvButton = findViewById(R.id.export_csv_button);\n        entrantsMapView = findViewById(R.id.entrants_map_view);\n        \n        // Initialize OpenStreetMap\n        if (entrantsMapView != null) {\n            // Set user agent (required by OpenStreetMap)\n            Configuration.getInstance().load(this, getSharedPreferences(\"osmdroid\", MODE_PRIVATE));\n            Configuration.getInstance().setUserAgentValue(getPackageName());\n            \n            // Set tile source\n            entrantsMapView.setTileSource(TileSourceFactory.MAPNIK);\n            \n            // Enable multi-touch controls\n            entrantsMapView.setMultiTouchControls(true);\n            \n            // Get map controller\n            mapController = entrantsMapView.getController();\n            mapController.setZoom(10.0);\n        }\n        \n        filterAllTab = findViewById(R.id.filter_all_tab);\n        filterPendingTab = findViewById(R.id.filter_pending_tab);\n        filterSelectedTab = findViewById(R.id.filter_selected_tab);\n        filterDeclinedTab = findViewById(R.id.filter_declined_tab);\n        \n        // Back button\n        ImageView backButton = findViewById(R.id.back_button);\n        backButton.setOnClickListener(v -> finish());\n        \n        // Setup RecyclerView\n        adapter = new WaitingListAdapter(filteredEntrants);\n        entrantsRecyclerView.setLayoutManager(new LinearLayoutManager(this));\n        entrantsRecyclerView.setAdapter(adapter);\n        \n        // Setup search\n        searchEditText.addTextChangedListener(new TextWatcher() {\n            @Override\n            public void beforeTextChanged(CharSequence s, int start, int count, int after) {}\n            \n            @Override\n            public void onTextChanged(CharSequence s, int start, int before, int count) {\n                filterEntrants();\n            }\n            \n            @Override\n            public void afterTextChanged(Editable s) {}\n        });\n        \n        // Initialize filter tabs\n        updateFilterTabs();\n    }\n    \n    @Override\n    protected void onResume() {\n        super.onResume();\n        if (entrantsMapView != null) {\n            entrantsMapView.onResume();\n        }\n        // Refresh data when returning to this activity\n        if (eventId != null) {\n            loadEventData();\n            loadEntrants();\n        }\n    }\n    \n    @Override\n    protected void onPause() {\n        super.onPause();\n        if (entrantsMapView != null) {\n            entrantsMapView.onPause();\n        }\n    }\n    \n    @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        if (entrantsMapView != null) {\n            entrantsMapView.onDetach();\n        }\n    }\n    \n    private void setupClickListeners() {\n        // Filter tabs\n        filterAllTab.setOnClickListener(v -> setFilter(\"all\"));\n        filterPendingTab.setOnClickListener(v -> setFilter(\"pending\"));\n        filterSelectedTab.setOnClickListener(v -> setFilter(\"selected\"));\n        filterDeclinedTab.setOnClickListener(v -> setFilter(\"declined\"));\n        \n        // Run Lottery button - uses same logic as OrganizerEventDetailsActivity\n        runLotteryButton.setOnClickListener(v -> runLottery());\n        \n        // Export CSV button\n        exportCsvButton.setOnClickListener(v -> exportCsv());\n        \n        // Bottom navigation tabs\n        TabLayout bottomNav = findViewById(R.id.bottom_navigation);\n        bottomNav.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {\n            @Override\n            public void onTabSelected(TabLayout.Tab tab) {\n                int position = tab.getPosition();\n                if (position == 0) {\n                    // Dashboard\n                    Intent intent = new Intent(EntrantListActivity.this, com.example.eventlotteryapp.OrganizerHomePage.class);\n                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK);\n                    startActivity(intent);\n                    finish();\n                } else if (position == 1) {\n                    // Create\n                    Intent intent = new Intent(EntrantListActivity.this, CreateEventActivity.class);\n                    startActivity(intent);\n                    finish();\n                } else if (position == 2) {\n                    // Notifications - handled by OrganizerHomePage\n                    Intent intent = new Intent(EntrantListActivity.this, com.example.eventlotteryapp.OrganizerHomePage.class);\n                    intent.putExtra(\"tab\", \"notifications\");\n                    startActivity(intent);\n                    finish();\n                } else if (position == 3) {\n                    // Profile - handled by OrganizerHomePage\n                    Intent intent = new Intent(EntrantListActivity.this, com.example.eventlotteryapp.OrganizerHomePage.class);\n                    intent.putExtra(\"tab\", \"profile\");\n                    startActivity(intent);\n                    finish();\n                }\n            }\n            \n            @Override\n            public void onTabUnselected(TabLayout.Tab tab) {}\n            \n            @Override\n            public void onTabReselected(TabLayout.Tab tab) {}\n        });\n    }\n    \n    private void setFilter(String filter) {\n        currentFilter = filter;\n        updateFilterTabs();\n        filterEntrants();\n    }\n    \n    private void updateFilterTabs() {\n        // Reset all tabs\n        resetFilterTab(filterAllTab);\n        resetFilterTab(filterPendingTab);\n        resetFilterTab(filterSelectedTab);\n        resetFilterTab(filterDeclinedTab);\n        \n        // Highlight selected tab\n        switch (currentFilter) {\n            case \"all\":\n                highlightFilterTab(filterAllTab);\n                break;\n            case \"pending\":\n                highlightFilterTab(filterPendingTab);\n                break;\n            case \"selected\":\n                highlightFilterTab(filterSelectedTab);\n                break;\n            case \"declined\":\n                highlightFilterTab(filterDeclinedTab);\n                break;\n        }\n    }\n    \n    private void resetFilterTab(LinearLayout tab) {\n        for (int i = 0; i < tab.getChildCount(); i++) {\n            View child = tab.getChildAt(i);\n            if (child instanceof ImageView) {\n                ((ImageView) child).setColorFilter(getResources().getColor(R.color.medium_grey, null));\n            } else if (child instanceof TextView) {\n                TextView textView = (TextView) child;\n                textView.setTextColor(getResources().getColor(R.color.black, null));\n                textView.setTypeface(null, android.graphics.Typeface.NORMAL);\n            }\n        }\n    }\n    \n    private void highlightFilterTab(LinearLayout tab) {\n        for (int i = 0; i < tab.getChildCount(); i++) {\n            View child = tab.getChildAt(i);\n            if (child instanceof ImageView) {\n                ((ImageView) child).setColorFilter(getResources().getColor(R.color.selected_tab_color, null));\n            } else if (child instanceof TextView) {\n                TextView textView = (TextView) child;\n                textView.setTextColor(getResources().getColor(R.color.selected_tab_color, null));\n                textView.setTypeface(null, android.graphics.Typeface.BOLD);\n            }\n        }\n    }\n    \n    private void loadEventData() {\n        firestore.collection(\"Events\").document(eventId)\n            .get()\n            .addOnSuccessListener(document -> {\n                if (!document.exists()) {\n                    Toast.makeText(this, \"Event not found\", Toast.LENGTH_SHORT).show();\n                    finish();\n                    return;\n                }\n                \n                // Event name\n                String title = document.getString(\"title\");\n                if (title == null) title = document.getString(\"Name\");\n                if (title != null) {\n                    eventNameText.setText(title);\n                }\n                \n                // Registration ends date\n                Date registrationCloseDate = document.getDate(\"registrationCloseDate\");\n                if (registrationCloseDate != null) {\n                    String dateStr = dateFormat.format(registrationCloseDate);\n                    registrationEndsText.setText(\"Registration Ends: \" + dateStr);\n                } else {\n                    registrationEndsText.setText(\"Registration Ends: TBD\");\n                }\n                \n                // Check if geolocation is required (for reference, but map is always visible)\n                Boolean requireGeolocation = document.getBoolean(\"requireGeolocation\");\n                requiresGeolocation = (requireGeolocation != null && requireGeolocation);\n                \n                // Map is always visible\n                if (entrantsMapView != null) {\n                    entrantsMapView.setVisibility(View.VISIBLE);\n                }\n                \n                // Update statistics\n                updateStatistics(document);\n                \n                // Always load map markers (if any location data exists)\n                if (entrantsMapView != null) {\n                    loadEntrantLocations();\n                }\n            })\n            .addOnFailureListener(e -> {\n                Log.e(TAG, \"Error loading event\", e);\n                Toast.makeText(this, \"Error loading event\", Toast.LENGTH_SHORT).show();\n            });\n    }\n    \n    private void updateStatistics(DocumentSnapshot document) {\n        // Total Entrants (all entrants: waiting + selected + declined)\n        List<String> waitingList = (List<String>) document.get(\"waitingListEntrantIds\");\n        List<String> selectedList = (List<String>) document.get(\"selectedEntrantIds\");\n        List<String> cancelledList = (List<String>) document.get(\"cancelledEntrantIds\");\n        \n        int waitingCount = (waitingList != null) ? waitingList.size() : 0;\n        int selectedCount = (selectedList != null) ? selectedList.size() : 0;\n        int cancelledCount = (cancelledList != null) ? cancelledList.size() : 0;\n        int totalEntrants = waitingCount + selectedCount + cancelledCount;\n        \n        totalEntrantsText.setText(\"Total Entrants: \" + totalEntrants);\n        \n        // Slots Available\n        Long maxParticipantsLong = document.getLong(\"maxParticipants\");\n        int maxParticipants = (maxParticipantsLong != null) ? maxParticipantsLong.intValue() : 0;\n        \n        int slotsAvailable = Math.max(0, maxParticipants - selectedCount);\n        slotsAvailableText.setText(\"Slots Available: \" + slotsAvailable);\n    }\n    \n    private void loadEntrants() {\n        firestore.collection(\"Events\").document(eventId)\n            .get()\n            .addOnSuccessListener(document -> {\n                List<String> waitingListIds = (List<String>) document.get(\"waitingListEntrantIds\");\n                List<String> selectedIds = (List<String>) document.get(\"selectedEntrantIds\");\n                List<String> cancelledIds = (List<String>) document.get(\"cancelledEntrantIds\");\n                \n                allEntrants.clear();\n                filteredEntrants.clear();\n                \n                // Load all entrant details\n                List<String> allIds = new ArrayList<>();\n                if (waitingListIds != null) allIds.addAll(waitingListIds);\n                if (selectedIds != null) allIds.addAll(selectedIds);\n                if (cancelledIds != null) allIds.addAll(cancelledIds);\n                \n                final int[] loaded = {0};\n                final int total = allIds.size();\n                \n                if (total == 0) {\n                    filteredEntrants.clear();\n                    adapter.notifyDataSetChanged();\n                    return;\n                }\n                \n                for (String entrantId : allIds) {\n                    // Determine status\n                    String status = \"pending\";\n                    if (selectedIds != null && selectedIds.contains(entrantId)) {\n                        status = \"selected\";\n                    } else if (cancelledIds != null && cancelledIds.contains(entrantId)) {\n                        status = \"declined\";\n                    }\n                    \n                    final String finalStatus = status;\n                    \n                    firestore.collection(\"Users\").document(entrantId)\n                        .get()\n                        .addOnSuccessListener(userDoc -> {\n                            if (userDoc.exists()) {\n                                String name = userDoc.getString(\"Name\");\n                                String email = userDoc.getString(\"email\");\n                                // Try to get join date from user's joined events timestamp, or use current date as fallback\n                                Date joinedDate = new Date(); // Default to current date\n                                // Note: In a real implementation, you might want to track when they joined the waiting list\n                                \n                                EntrantWithStatus entrant = new EntrantWithStatus(\n                                    entrantId,\n                                    name != null ? name : \"Unknown\",\n                                    email != null ? email : \"\",\n                                    finalStatus,\n                                    joinedDate\n                                );\n                                \n                                allEntrants.add(entrant);\n                                \n                                loaded[0]++;\n                                if (loaded[0] == total) {\n                                    filterEntrants();\n                                }\n                            } else {\n                                loaded[0]++;\n                                if (loaded[0] == total) {\n                                    filterEntrants();\n                                }\n                            }\n                        })\n                        .addOnFailureListener(e -> {\n                            Log.e(TAG, \"Error loading entrant: \" + entrantId, e);\n                            loaded[0]++;\n                            if (loaded[0] == total) {\n                                filterEntrants();\n                            }\n                        });\n                }\n            })\n            .addOnFailureListener(e -> {\n                Log.e(TAG, \"Error loading entrants\", e);\n                Toast.makeText(this, \"Error loading entrants\", Toast.LENGTH_SHORT).show();\n            });\n    }\n    \n    private void filterEntrants() {\n        filteredEntrants.clear();\n        \n        String searchQuery = searchEditText.getText().toString().toLowerCase();\n        \n        for (EntrantWithStatus entrant : allEntrants) {\n            // Filter by status\n            boolean matchesFilter = currentFilter.equals(\"all\") || \n                                   entrant.status.equals(currentFilter);\n            \n            // Filter by search query\n            boolean matchesSearch = searchQuery.isEmpty() ||\n                                   entrant.name.toLowerCase().contains(searchQuery) ||\n                                   entrant.email.toLowerCase().contains(searchQuery);\n            \n            if (matchesFilter && matchesSearch) {\n                filteredEntrants.add(entrant);\n            }\n        }\n        \n        adapter.notifyDataSetChanged();\n    }\n    \n    private void runLottery() {\n        Intent intent = new Intent(this, RunLotteryActivity.class);\n        intent.putExtra(\"eventId\", eventId);\n        startActivity(intent);\n    }\n    \n    private void exportCsv() {\n        // Export all entrants (filtered or all based on current filter)\n        List<Entrant> entrantsToExport = new ArrayList<>();\n        for (EntrantWithStatus e : filteredEntrants) {\n            entrantsToExport.add(new Entrant(e.id, e.name, e.email));\n        }\n        \n        if (entrantsToExport.isEmpty()) {\n            Toast.makeText(this, \"No entrants to export\", Toast.LENGTH_SHORT).show();\n            return;\n        }\n        \n        firestore.collection(\"Events\").document(eventId)\n            .get()\n            .addOnSuccessListener(document -> {\n                String eventTitle = document.getString(\"title\");\n                if (eventTitle == null) eventTitle = document.getString(\"Name\");\n                if (eventTitle == null) eventTitle = \"Event\";\n                \n                csvExportController.exportFinalListToCSV(this, eventTitle + \"_waiting_list\", entrantsToExport);\n            })\n            .addOnFailureListener(e -> {\n                Log.e(TAG, \"Error loading event for export\", e);\n                csvExportController.exportFinalListToCSV(this, \"waiting_list\", entrantsToExport);\n            });\n    }\n    \n    // Helper class to store entrant with status\n    static class EntrantWithStatus {\n        String id;\n        String name;\n        String email;\n        String status; // pending, selected, declined\n        Date joinedDate;\n        \n        EntrantWithStatus(String id, String name, String email, String status, Date joinedDate) {\n            this.id = id;\n            this.name = name;\n            this.email = email;\n            this.status = status;\n            this.joinedDate = joinedDate;\n        }\n    }\n    \n    // Adapter for waiting list\n    private class WaitingListAdapter extends RecyclerView.Adapter<WaitingListAdapter.ViewHolder> {\n        private List<EntrantWithStatus> entrants;\n        \n        WaitingListAdapter(List<EntrantWithStatus> entrants) {\n            this.entrants = entrants;\n        }\n        \n        @NonNull\n        @Override\n        public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n            View view = LayoutInflater.from(parent.getContext())\n                .inflate(R.layout.item_waiting_list_entrant, parent, false);\n            return new ViewHolder(view);\n        }\n        \n        @Override\n        public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\n            EntrantWithStatus entrant = entrants.get(position);\n            \n            holder.nameText.setText(entrant.name);\n            holder.statusText.setText(entrant.status.substring(0, 1).toUpperCase() + entrant.status.substring(1));\n            \n            // Set status indicator color\n            int statusColorRes;\n            switch (entrant.status) {\n                case \"selected\":\n                    statusColorRes = R.drawable.status_indicator_green;\n                    break;\n                case \"declined\":\n                    statusColorRes = R.drawable.status_indicator_red;\n                    break;\n                default: // pending\n                    statusColorRes = R.drawable.status_indicator_yellow;\n                    break;\n            }\n            holder.statusIndicator.setBackgroundResource(statusColorRes);\n            \n            // Set joined date\n            if (entrant.joinedDate != null) {\n                holder.joinedDateText.setText(\"Joined \" + joinDateFormat.format(entrant.joinedDate));\n            } else {\n                holder.joinedDateText.setText(\"\");\n            }\n        }\n        \n        @Override\n        public int getItemCount() {\n            return entrants.size();\n        }\n        \n        class ViewHolder extends RecyclerView.ViewHolder {\n            TextView nameText;\n            TextView statusText;\n            View statusIndicator;\n            TextView joinedDateText;\n            \n            ViewHolder(@NonNull View itemView) {\n                super(itemView);\n                nameText = itemView.findViewById(R.id.entrant_name_text);\n                statusText = itemView.findViewById(R.id.status_text);\n                statusIndicator = itemView.findViewById(R.id.status_indicator);\n                joinedDateText = itemView.findViewById(R.id.joined_date_text);\n            }\n        }\n    }\n    \n    private void loadEntrantLocations() {\n        if (entrantsMapView == null || eventId == null) {\n            return;\n        }\n        \n        // Clear existing markers\n        entrantsMapView.getOverlays().clear();\n        \n        // Get all entrant IDs\n        firestore.collection(\"Events\").document(eventId)\n            .get()\n            .addOnSuccessListener(document -> {\n                List<String> waitingListIds = (List<String>) document.get(\"waitingListEntrantIds\");\n                List<String> selectedIds = (List<String>) document.get(\"selectedEntrantIds\");\n                List<String> cancelledIds = (List<String>) document.get(\"cancelledEntrantIds\");\n                \n                List<String> allEntrantIds = new ArrayList<>();\n                if (waitingListIds != null) allEntrantIds.addAll(waitingListIds);\n                if (selectedIds != null) allEntrantIds.addAll(selectedIds);\n                if (cancelledIds != null) allEntrantIds.addAll(cancelledIds);\n                \n                if (allEntrantIds.isEmpty()) {\n                    return;\n                }\n                \n                final List<GeoPoint> locations = new ArrayList<>();\n                final int[] loaded = {0};\n                final int total = allEntrantIds.size();\n                \n                // Load location for each entrant\n                for (String entrantId : allEntrantIds) {\n                    // Check for location in event-specific join location subcollection\n                    firestore.collection(\"Events\").document(eventId)\n                        .collection(\"joinLocations\").document(entrantId)\n                        .get()\n                        .addOnSuccessListener(locationDoc -> {\n                            if (locationDoc.exists()) {\n                                Double latitude = locationDoc.getDouble(\"latitude\");\n                                Double longitude = locationDoc.getDouble(\"longitude\");\n                                \n                                if (latitude != null && longitude != null) {\n                                    GeoPoint location = new GeoPoint(latitude, longitude);\n                                    locations.add(location);\n                                    \n                                    // Get entrant name for marker\n                                    firestore.collection(\"Users\").document(entrantId)\n                                        .get()\n                                        .addOnSuccessListener(userDoc -> {\n                                            String name = userDoc.getString(\"Name\");\n                                            if (name == null) name = \"Unknown\";\n                                            \n                                            // Create marker\n                                            Marker marker = new Marker(entrantsMapView);\n                                            marker.setPosition(location);\n                                            marker.setTitle(name);\n                                            marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM);\n                                            \n                                            entrantsMapView.getOverlays().add(marker);\n                                            \n                                            loaded[0]++;\n                                            if (loaded[0] == total) {\n                                                // All loaded, adjust camera to show all markers\n                                                if (!locations.isEmpty()) {\n                                                    adjustCameraToMarkers(locations);\n                                                }\n                                            }\n                                            \n                                            entrantsMapView.invalidate();\n                                        })\n                                        .addOnFailureListener(e -> {\n                                            Log.e(TAG, \"Error loading entrant name: \" + entrantId, e);\n                                            \n                                            // Create marker without name\n                                            Marker marker = new Marker(entrantsMapView);\n                                            marker.setPosition(location);\n                                            marker.setTitle(\"Entrant\");\n                                            marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM);\n                                            \n                                            entrantsMapView.getOverlays().add(marker);\n                                            \n                                            loaded[0]++;\n                                            if (loaded[0] == total) {\n                                                adjustCameraToMarkers(locations);\n                                            }\n                                            \n                                            entrantsMapView.invalidate();\n                                        });\n                                } else {\n                                    loaded[0]++;\n                                    if (loaded[0] == total) {\n                                        adjustCameraToMarkers(locations);\n                                    }\n                                }\n                            } else {\n                                // Try to get location from user document (if stored there)\n                                firestore.collection(\"Users\").document(entrantId)\n                                    .get()\n                                    .addOnSuccessListener(userDoc -> {\n                                        // Check for location in user's joined events data\n                                        // This would need to be implemented when users join\n                                        loaded[0]++;\n                                        if (loaded[0] == total) {\n                                            adjustCameraToMarkers(locations);\n                                        }\n                                    })\n                                    .addOnFailureListener(e -> {\n                                        loaded[0]++;\n                                        if (loaded[0] == total) {\n                                            adjustCameraToMarkers(locations);\n                                        }\n                                    });\n                            }\n                        })\n                        .addOnFailureListener(e -> {\n                            Log.e(TAG, \"Error loading location for entrant: \" + entrantId, e);\n                            loaded[0]++;\n                            if (loaded[0] == total) {\n                                adjustCameraToMarkers(locations);\n                            }\n                        });\n                }\n            })\n            .addOnFailureListener(e -> {\n                Log.e(TAG, \"Error loading event for locations\", e);\n            });\n    }\n    \n    private void adjustCameraToMarkers(List<GeoPoint> locations) {\n        if (locations.isEmpty() || mapController == null) {\n            return;\n        }\n        \n        if (locations.size() == 1) {\n            // Single marker - center on it\n            mapController.setCenter(locations.get(0));\n            mapController.setZoom(12.0);\n        } else {\n            // Multiple markers - calculate bounds\n            double minLat = locations.get(0).getLatitude();\n            double maxLat = locations.get(0).getLatitude();\n            double minLng = locations.get(0).getLongitude();\n            double maxLng = locations.get(0).getLongitude();\n            \n            for (GeoPoint location : locations) {\n                minLat = Math.min(minLat, location.getLatitude());\n                maxLat = Math.max(maxLat, location.getLatitude());\n                minLng = Math.min(minLng, location.getLongitude());\n                maxLng = Math.max(maxLng, location.getLongitude());\n            }\n            \n            GeoPoint center = new GeoPoint((minLat + maxLat) / 2, (minLng + maxLng) / 2);\n            double latSpan = maxLat - minLat;\n            double lngSpan = maxLng - minLng;\n            double maxSpan = Math.max(latSpan, lngSpan);\n            \n            // Calculate zoom level\n            double zoom = maxSpan > 0 ? Math.log(360 / maxSpan) / Math.log(2) : 12.0;\n            zoom = Math.max(zoom - 1.0, 8.0); // Minimum zoom level\n            \n            mapController.setCenter(center);\n            mapController.setZoom(zoom);\n        }\n        \n        entrantsMapView.invalidate();\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/eventlotteryapp/organizer/EntrantListActivity.java b/app/src/main/java/com/example/eventlotteryapp/organizer/EntrantListActivity.java
--- a/app/src/main/java/com/example/eventlotteryapp/organizer/EntrantListActivity.java	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ b/app/src/main/java/com/example/eventlotteryapp/organizer/EntrantListActivity.java	(date 1764125335906)
@@ -147,7 +147,7 @@
         adapter = new WaitingListAdapter(filteredEntrants);
         entrantsRecyclerView.setLayoutManager(new LinearLayoutManager(this));
         entrantsRecyclerView.setAdapter(adapter);
-        
+
         // Setup search
         searchEditText.addTextChangedListener(new TextWatcher() {
             @Override
@@ -306,7 +306,7 @@
     
     private void loadEventData() {
         firestore.collection("Events").document(eventId)
-            .get()
+                .get()
             .addOnSuccessListener(document -> {
                 if (!document.exists()) {
                     Toast.makeText(this, "Event not found", Toast.LENGTH_SHORT).show();
Index: app/src/main/res/drawable/edit_text_custom_bg.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:shape=\"rectangle\">\n    <solid android:color=\"@color/opaque_light_grey\" />\n    <corners android:radius=\"8dp\" />\n</shape>\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/edit_text_custom_bg.xml b/app/src/main/res/drawable/edit_text_custom_bg.xml
--- a/app/src/main/res/drawable/edit_text_custom_bg.xml	(revision 893401fa278fcafa5dc16933a73cc540518bf7b2)
+++ b/app/src/main/res/drawable/edit_text_custom_bg.xml	(date 1764125336060)
@@ -3,4 +3,4 @@
     android:shape="rectangle">
     <solid android:color="@color/opaque_light_grey" />
     <corners android:radius="8dp" />
-</shape>
+        </shape>
